# План деплоя Booomerangs в Yandex Cloud

Поскольку вы планируете перенос в Yandex Cloud (YC), я подготовил архитектуру, которая позволит легко это сделать.

## 1. База данных (Managed Service for PostgreSQL)
*   **Действие:** Создайте кластер PostgreSQL в Yandex Cloud.
*   **Связь:** После создания вы получите `DATABASE_URL`. Вам нужно будет просто заменить текущую ссылку в секретах.
*   **Миграции:** На сайте используется Drizzle ORM, поэтому при первом запуске на Яндексе таблицы создадутся автоматически.

## 2. Хранение изображений (Object Storage)
*   **Действие:** Создайте бакет в Yandex Object Storage.
*   **Зачем:** В облачных функциях нельзя хранить файлы "на диске" (они стираются). Все фото товаров будут лежать в бакете Яндекса.
*   **Код:** Я уже добавил модуль `server/lib/storage-s3.ts`, который умеет работать с S3 Яндекса. Вам нужно будет только прописать ключи доступа (`YC_ACCESS_KEY`, `YC_SECRET_KEY`).

## 3. Хостинг и Функции (Cloud Functions / Serverless Containers)
*   **Вариант А (Простой):** **Yandex Serverless Containers**. Вы упаковываете проект в Docker-контейнер, и Яндекс сам его запускает. Это идеальный вариант для Express-сервера.
*   **Вариант Б (Масштабируемый):** **Yandex Cloud Functions**. Подходит для отдельных API-запросов (например, только для синхронизации с 1С).

## 4. Статика (Frontend)
*   **Действие:** Скомпилированный фронтенд (папка `dist`) можно положить в тот же Object Storage и настроить его как "Хостинг статического сайта". Это будет работать очень быстро.

## 5. Сборка и деплой (Docker)

Для запуска в Serverless Containers мы используем Docker. Я уже подготовил `Dockerfile` в корне проекта.

### Команды для деплоя:

1. **Сборка образа:**
   ```bash
   docker build -t cr.yandex/<идентификатор_реестра>/booomerangs:v1 .
   ```

2. **Загрузка в реестр Яндекса:**
   ```bash
   docker push cr.yandex/<идентификатор_реестра>/booomerangs:v1
   ```

3. **Создание контейнера в консоли YC:**
   * Выберите образ `booomerangs:v1`.
   * Укажите порт `5000`.
   * Добавьте переменные окружения из секретов Replit.

---

### Что я подготовил в коде для этого:
1.  **Stateless-архитектура:** Сервер не хранит данные в памяти, всё идет в базу или S3.
2.  **Dockerfile:** Оптимизированный многоэтапный билд для минимального размера контейнера.
3.  **Переменные окружения:** Все настройки вынесены в конфиг.

**Когда будете готовы к переносу:**
Я помогу вам собрать проект и дам команды для консоли `yc`, чтобы всё "взлетело" в облаке.
